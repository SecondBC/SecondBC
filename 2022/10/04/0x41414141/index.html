<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>1094795585 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="BackupkeysCan you recover my backup keys to get the flag , they probably are hardcoded ? 提示说明 flag 是硬编码； 进入IDA只有start和零散的几个函数，说明加壳了； 用16进制查看器搜UPX可以发现 UPX! 标志； 脱壳后看main函数：  在最下方的输出 try harder的另一条线上有一个输">
<meta property="og:type" content="article">
<meta property="og:title" content="1094795585">
<meta property="og:url" content="https://secondbc.github.io/SecondBC/2022/10/04/0x41414141/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="BackupkeysCan you recover my backup keys to get the flag , they probably are hardcoded ? 提示说明 flag 是硬编码； 进入IDA只有start和零散的几个函数，说明加壳了； 用16进制查看器搜UPX可以发现 UPX! 标志； 脱壳后看main函数：  在最下方的输出 try harder的另一条线上有一个输">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2022/10/03/CSgXzEMV4Z1LjYD.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/03/9Ty1V4DXIGBQqm3.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/03/nhFodMJmyUXiKzI.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/03/aeJj91hNIT2ozlP.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/03/GpBMo9VZQwleg6J.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/04/SprgcPE8LWuNDdn.png">
<meta property="article:published_time" content="2022-10-04T07:43:43.000Z">
<meta property="article:modified_time" content="2022-10-04T07:44:27.040Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/10/03/CSgXzEMV4Z1LjYD.png">
  
    <link rel="alternate" href="/SecondBC/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/SecondBC/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/SecondBC/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/SecondBC/">Home</a>
        
          <a class="main-nav-link" href="/SecondBC/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/SecondBC/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://secondbc.github.io/SecondBC"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-0x41414141" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/SecondBC/2022/10/04/0x41414141/" class="article-date">
  <time datetime="2022-10-04T07:43:43.000Z" itemprop="datePublished">2022-10-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      1094795585
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Backupkeys"><a href="#Backupkeys" class="headerlink" title="Backupkeys"></a>Backupkeys</h2><p>Can you recover my backup keys to get the flag , they probably are hardcoded ?</p>
<p>提示说明 flag 是硬编码；</p>
<p>进入IDA只有start和零散的几个函数，说明加壳了；</p>
<p>用16进制查看器搜UPX可以发现 UPX! 标志；</p>
<p>脱壳后看main函数：</p>
<p><img src="https://s2.loli.net/2022/10/03/CSgXzEMV4Z1LjYD.png" alt="main"></p>
<p>在最下方的输出 try harder的另一条线上有一个输出：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;Phew Phew collect the keys below , don&#x27;t forget to put them in flag&#123;&#125; format&quot;</span></span><br></pre></td></tr></table></figure>

<p>消除逗号得到硬编码的flag：<strong>flag{Hardcodedpasswordsareuseless}</strong></p>
<h2 id="X-and-or"><a href="#X-and-or" class="headerlink" title="X-and-or"></a>X-and-or</h2><p>查看main：</p>
<p><img src="https://s2.loli.net/2022/10/03/9Ty1V4DXIGBQqm3.png" alt="main"></p>
<p>code是一个运行后设置的地址，跳转到主要函数；从code里的判断可得知，输入长度为38；进入运算后循环38次，内部有固定数字进行异或运算并与输入内容比较；</p>
<p><img src="https://s2.loli.net/2022/10/03/nhFodMJmyUXiKzI.png" alt="code"></p>
<p>循环的结尾是比较数据，需要使得eax最终为0；经过调试可以发现每次异或0~5的立方，满6归0；</p>
<p>写出脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">origin = [<span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x69</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x48</span>, <span class="number">0x36</span>, <span class="number">0x31</span>, <span class="number">0x3E</span>, <span class="number">0x28</span>, <span class="number">0x77</span>, <span class="number">0x19</span>, <span class="number">0x63</span>, <span class="number">0x31</span>, <span class="number">0x6C</span>, <span class="number">0x78</span>, <span class="number">0x24</span>, <span class="number">0x4E</span>, <span class="number">0x33</span>, <span class="number">0x63</span>, <span class="number">0x3D</span>, <span class="number">0x7D</span>, <span class="number">0x26</span>, <span class="number">0x4E</span>, <span class="number">0x37</span>, <span class="number">0x39</span>, <span class="number">0x30</span>, <span class="number">0x2B</span>, <span class="number">0x23</span>, <span class="number">0x1C</span>, <span class="number">0x31</span>, <span class="number">0x31</span>, <span class="number">0x6A</span>, <span class="number">0x29</span>, <span class="number">0x74</span>, <span class="number">0x1B</span>, <span class="number">0x62</span>, <span class="number">0x7C</span>]</span><br><span class="line"></span><br><span class="line">flag = [<span class="number">0</span>] * <span class="number">38</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    flag[i] = <span class="built_in">chr</span>(((k*k*k)) ^ origin[i])</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">6</span>:</span><br><span class="line">        k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br></pre></td></tr></table></figure>

<p>由此得到flag：<strong>flag{560637dc0dcd33b5ff37880ca10b24fb}</strong></p>
<p>这题最有意思的是init函数，他把code的二进制内容异或上了0x42，需要将其变回来则再异或0x42，然后写在新的txt里，用IDA反编译，设置sp值，然后就能看到伪代码了：</p>
<p><img src="https://s2.loli.net/2022/10/03/aeJj91hNIT2ozlP.png" alt="code"></p>
<h2 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h2><p>I received a corrupted program the keys are probably lost within the game can you just find it for me to get the flag?.</p>
<p>Flag format : flag{key1+key2}</p>
<p>一开始看main觉得很奇怪，明明汇编有其他分支为什么伪代码始终显示的是 oops wrong path ？</p>
<p>结果发现是因为跳转的地方动了手脚：</p>
<p><img src="https://s2.loli.net/2022/10/03/GpBMo9VZQwleg6J.png" alt="jmp"></p>
<p>它始终都是判断必走另一条路，所以找不到正确的上下文；本来以为很难的题一下就变成了渣渣题；</p>
<p>里里外外都改一下jmp，再运行一遍，它就自己吐flag了；</p>
<p>得出：<strong>flag{456789JKLq59U1337}</strong></p>
<h2 id="Cage"><a href="#Cage" class="headerlink" title="Cage"></a>Cage</h2><p>Are you aware of the scopes yet?</p>
<p>开场patch main_one函数得到正确的上下文；</p>
<p><img src="https://s2.loli.net/2022/10/04/SprgcPE8LWuNDdn.png" alt="main"></p>
<p>发现需要输入一系列magic code，然后它会吐出已有的字符串，直接将字符串拼起来得到flag：</p>
<p><strong>flag{0xm4tr1xreal}</strong></p>
<h2 id="Ware"><a href="#Ware" class="headerlink" title="Ware"></a>Ware</h2><p>My plaintext has been encrypted by an innocent friend of mine while playing around cryptographic libraries, can you help me to recover the plaintext , remembers it’s just numbers and there’s a space between some numbers which you need to remove the space and submit the recovered plain text as a flag.</p>
<p>开始一个upx直接脱掉；</p>
<p>搜索运行时的字符串得到flag：<strong>flag{32117406899806798980909}</strong></p>
<h2 id="WrongDownload"><a href="#WrongDownload" class="headerlink" title="WrongDownload"></a>WrongDownload</h2><p>My key has been missing inside these two binaries can you help me to find it out ,as per my friend the key is divided in two parts between the two binaries so, remember you need to join them up before submitting as a flag.</p>
<p>直接反编译就能找到：<strong>flag{S6c56bnXQiBjk9mqSYE7ykVQ7NzrRy}</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://secondbc.github.io/SecondBC/2022/10/04/0x41414141/" data-id="cl8twbcpw0000xwvcdwyy2nl1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/SecondBC/2022/10/01/Proxy-lab/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Proxy_lab</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/SecondBC/archives/2021/12/">December 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/SecondBC/2022/10/04/0x41414141/">1094795585</a>
          </li>
        
          <li>
            <a href="/SecondBC/2022/10/01/Proxy-lab/">Proxy_lab</a>
          </li>
        
          <li>
            <a href="/SecondBC/2022/09/11/Malloc-Lab/">Malloc_Lab</a>
          </li>
        
          <li>
            <a href="/SecondBC/2022/08/18/%E5%81%87%E6%9C%9F%E5%A4%8D%E7%8E%B0/">假期复现</a>
          </li>
        
          <li>
            <a href="/SecondBC/2022/04/23/Shell-Lab/">Shell_Lab</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/SecondBC/" class="mobile-nav-link">Home</a>
  
    <a href="/SecondBC/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/SecondBC/fancybox/jquery.fancybox.css">

  
<script src="/SecondBC/fancybox/jquery.fancybox.pack.js"></script>




<script src="/SecondBC/js/script.js"></script>




  </div>
</body>
</html>